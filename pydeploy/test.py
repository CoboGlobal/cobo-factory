from .utils import (get_create2_address, get_create_address,
                    get_factory_create2_address, get_factory_create3_address)


def test_create():
    addr = get_create_address("0x01176D1f31C6031Ad95a5c18c8C3833aF283Dc2E", 0)
    assert addr == "0xd64aa6d32fab61e94a8392ce960115e7878041a0"

    addr = get_create2_address(
        addr,
        "0x6465765f76320000000000000000000000000000000000000000000000000000",
        "0x60806040526102de8038038061001481610194565b92833981019060408183031261018f5780516001600160a01b03811680820361018f5760208381015190936001600160401b03821161018f570184601f8201121561018f5780519061006d610068836101cf565b610194565b9582875285838301011161018f57849060005b83811061017b57505060009186010152813b15610163577f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc80546001600160a01b03191682179055604051907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b600080a28351156101455750600080848461012c96519101845af4903d1561013c573d61011c610068826101cf565b908152600081943d92013e6101ea565b505b6040516090908161024e8239f35b606092506101ea565b9250505034610154575061012e565b63b398979f60e01b8152600490fd5b60249060405190634c9c8ce360e01b82526004820152fd5b818101830151888201840152869201610080565b600080fd5b6040519190601f01601f191682016001600160401b038111838210176101b957604052565b634e487b7160e01b600052604160045260246000fd5b6001600160401b0381116101b957601f01601f191660200190565b9061021157508051156101ff57805190602001fd5b604051630a12f52160e11b8152600490fd5b81511580610244575b610222575090565b604051639996b31560e01b81526001600160a01b039091166004820152602490fd5b50803b1561021a56fe608060405273ffffffffffffffffffffffffffffffffffffffff7f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc54166000808092368280378136915af43d82803e156056573d90f35b3d90fdfea2646970667358221220f5223a996021fd963ccf4a0f41ae34ab8a29131cbcfea4261886f7c197a100cf64736f6c63430008140033000000000000000000000000c4500af11fc158420089520cbc2dd12a5d47816e00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000024c4d66de8000000000000000000000000965cebc1c9e81c951067e3905b0ce84df34b55d000000000000000000000000000000000000000000000000000000000",
    )
    assert addr == "0x0255ac7FBA39b0e5cbcfdBB6CD70CccDe174cB1e".lower()


SALT = b"\x00" * 31 + b"\x01"
CODE = bytes.fromhex("67363d3d37363d34f03d5260086018f3")
DEPLOYER = "0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496"
FACTORY = "0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f"


def test_factory():
    addr = get_factory_create2_address(FACTORY, SALT, CODE)
    assert addr == "0xa8Bb576923198bbc6C66267d8900CF3b69c0472D".lower()

    addr = get_factory_create2_address(FACTORY, SALT, CODE, DEPLOYER)
    assert addr == "0xE6500D723480e95c6B4766bDAe759cDf47BDcC83".lower()

    addr = get_factory_create3_address(FACTORY, SALT)
    assert addr == "0x213e6FfF3a309E28EA856F04439eaf24e8a2fa14".lower()

    addr = get_factory_create3_address(FACTORY, SALT, DEPLOYER)
    assert addr == "0x95969B73f37da84E7681d770f5fF563046000fa9".lower()